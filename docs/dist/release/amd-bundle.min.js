var __extends=this&&this.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function makeid(e){for(var t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=r.length,o=0;o<e;o++)t+=r.charAt(Math.floor(Math.random()*n));return t}var formFieldBuild,storageKey=location.pathname.replace(/\/$/s,"")+"/formField",formSaved=localStorage.getItem(storageKey.toString()),formField=formFieldBuild=formSaved?JSON.parse(formSaved):[],uniqueid=makeid(5),isBrowser=new Function("try {return this===window;}catch(e){ return false;}"),Count=-1;if("undefined"==typeof Storage)var Storage_1=function(){};var lStorage=function(e){function t(t){void 0===t&&(t="");var r=e.call(this)||this;return r.prefix="",r.prefix=t,r}return __extends(t,e),t.prototype.has=function(e){return!!localStorage[this.prefix+e]&&!!localStorage[this.prefix+e].length},t.prototype.get=function(e){if(!this.has(this.prefix+e))return!1;var t=localStorage[this.prefix+e];try{return JSON.parse(t)}catch(e){return t}},t.prototype.set=function(e,t){try{localStorage.setItem(this.prefix+e,JSON.stringify(t))}catch(r){localStorage.setItem(this.prefix+e,t)}},t.prototype.extend=function(e,t){if(this.has(this.prefix+e)){var r=this.get(this.prefix+e);"undefined"!=typeof jQuery&&$.extend(r,JSON.parse(JSON.stringify(t))),this.set(this.prefix+e,r)}else this.set(this.prefix+e,t)},t.prototype.remove=function(e){localStorage.removeItem(this.prefix+e)},t}(Storage),formSaver2Storage=function(){function e(){}return e.set=function(e,t){("object"==typeof t||Array.isArray(t))&&(t=JSON.stringify(t)),"string"!=typeof t&&(t=new String(t)),localStorage.setItem(e,t)},e.get=function(e,t){var r=localStorage.getItem(e);return this.IsJsonString(r)&&(r=JSON.parse(r)),null!=r?r:t},e.IsJsonString=function(e){if(null==e)return!1;try{JSON.parse(e)}catch(e){return!1}return!0},e}(),formSaver2=function(){function e(t,r){"object"!=typeof r&&(r={}),void 0===(r=Object.assign({debug:!1,method:"vanilla"},r)).debug&&(r.debug=!1,console.log("change debug to false")),e.restore(t,r.debug),t.hasAttribute("formsaver-integrity")||("jquery"==r.method&&e.is_jquery()?e.jquery_listener():e.vanilla_listener(t,(function(){console.log(arguments),e.save(t,r.debug)})))}return e.offset=function(e){return e.getBoundingClientRect()},e.jquery_listener=function(){$(document).bind("DOMNodeInserted",(function(){switch($(this).prop("tagName")){case"SELECT":case"INPUT":case"TEXTAREA":e.restore($(this).get(0))}})),$(document).bind("DOMNodeRemoved",(function(){var e=$(this);if(!e.attr("no-save")&&e.attr("formsaver-integrity"))switch(e.prop("tagName")){case"SELECT":case"INPUT":case"TEXTAREA":e.off("change")}})),$(document).on("change","select, input, textarea",(function(t){e.save(this)})),$(document).on("focus","input,textarea,select",(function(){var e=$(this);e.getIDName();var t=e.attr("formsaver-integrity");t&&t!=uniqueid&&(console.log("aria id invalid"),e.smartForm(),e.attr("formsaver-integrity",uniqueid))}))},e.vanilla_listener=function(e,t){e.addEventListener?e.addEventListener("change",t):e.attachEvent&&e.attachEvent("onchange",t)},e.hasAttribute=function(e,t){return 1===e.nodeType&&e.hasAttribute(t)},e.convertElement=function(e){this.is_jquery()&&e instanceof jQuery&&(e=e.get(0));e.nodeType;return e},e.restore=function(e,t){if(void 0===t&&(t=!1),e=this.convertElement(e),Count++,!e.hasAttribute("no-save")){var r;e.setAttribute("formsaver-integrity",uniqueid);var n=this.get_identifier(e),o=e.getAttribute("type");if(n.length>0){if("checkbox"===o){if(null===(r=JSON.parse(localStorage.getItem(n))))return;return t&&console.log("restore value checkbox["+n+"] "+r),void(e.checked=r)}if("radio"===o){var i=localStorage.getItem(n);formSaver2Storage.IsJsonString(i)&&(i=JSON.parse(i));for(var a=document.getElementsByName(e.getAttribute("name")),s=0;s<a.length;s++)a[s].checked=!1;return void setTimeout((function(){i&&"object"==typeof i&&i.hasOwnProperty("index")&&(a[i.index].checked=!0,t&&console.log("restoring checkbox",i))}),1e3)}if(null===(r=localStorage.getItem(n))||!r.toString().length)return;e.value=r,this.is_select2(e)&&(console.log("restoring "+e.getAttribute("id")+" which Initialized select2"),$(e).val(r).trigger("change"))}}},e.save=function(t,r){void 0===r&&(r=!1),t=this.convertElement(t);var n=this.get_identifier(t),o=t.value,i=!t.hasAttribute("no-save")&&t.hasAttribute("formsaver-integrity")&&t.hasAttribute("name");if(r&&console.log(t.tagName+" "+n+" "+i),n&&""!==o&&i){if("checkbox"==t.getAttribute("type"))return localStorage.setItem(n,(1==t.checked).toString()),void(r&&console.log("save checkbox button ",e.offset(t)));if("radio"==t.getAttribute("type")){for(var a=document.getElementsByName(t.getAttribute("name")),s=getCheckedValue(a),u=0;u<a.length;u++)if(a.hasOwnProperty(u)){var c=a[u];this.delete(c,r)}return void setTimeout((function(){localStorage.setItem(n,JSON.stringify(s)),r&&console.log("save radio button ",s)}),1e3)}localStorage.setItem(n,o.toString())}},e.delete=function(e,t){void 0===t&&(t=!1),e=this.convertElement(e);var r=this.get_identifier(e);t&&console.log("deleting "+r),localStorage.removeItem(r)},e.is_select2=function(e){return this.is_jquery()&&$(e).data("select2")},e.is_jquery=function(){return"undefined"!=typeof jQuery},e.get_identifier=function(e){var t=function(t){var r;return Count in formField?(r=formField[Count],e.setAttribute(t,r)):(r=makeid(5),e.setAttribute(t,r),formField[Count]=r,localStorage.setItem(storageKey.toString(),JSON.stringify(formField))),Count++,r},r=function(t){var r=makeid(5);return e.setAttribute(t,r),formField[Count]=r,localStorage.setItem(storageKey.toString(),JSON.stringify(formField)),r},n=null,o=null;return(e=this.convertElement(e)).hasAttribute("id")?"null"==e.getAttribute("id")&&(o=r("id")):n=t("id"),e.hasAttribute("name")?"null"==e.getAttribute("name")&&("string"!=typeof o?r("name"):e.setAttribute("name",o)):"string"!=typeof n?t("name"):e.setAttribute("name",n),location.pathname+e.getAttribute("id")},e}();function getCheckedValue(e){for(var t={},r=0,n=e.length;r<n;r++)e[r].checked&&(t={value:e[r].value,index:r,id:formSaver2.get_identifier(e[r])});return t}function formsaver(e){if(void 0===e&&(e=!1),console.log("Formsaver "+e),"undefined"!=typeof jQuery)e&&console.log("starting form saver with jQuery"),"undefined"!=typeof jQuery&&jQuery("input,textarea,select").each((function(t,r){new formSaver2(this,{debug:e,method:"jquery"})}));else{e&&console.log("starting form saver without jQuery");var t=document.querySelectorAll("input,textarea,select");e&&console.log(t),t.forEach((function(t,r,n){new formSaver2(t,{debug:e,method:"vanilla"})}))}}isBrowser()&&"undefined"!=typeof jQuery&&function(e){e.fn.getIDName=function(){return e(this).attr("aria-autovalue")&&e(this).val(uniqueid).trigger("change"),formSaver2.get_identifier(this)},e.fn.has_attr=function(t){var r=e(this).attr(t);return void 0!==r&&!1!==r},e.fn.smartForm=function(){Count++,new formSaver2(e(this).get(0))},e.arrive=function(t,r){t?e(t).bind("DOMNodeInserted",r):"function"==typeof r?e(document).bind("DOMNodeInserted",r):"function"==typeof t&&e(document).bind("DOMNodeInserted",t)}}(jQuery),define("browserify",["require","exports","./_conf","./formSaver2","./jquery-saver","./main"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}));