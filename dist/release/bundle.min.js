function makeid(e){let t="";const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=r.length;for(let n=0;n<e;n++)t+=r.charAt(Math.floor(Math.random()*i));return t}Object.size=function(e){var t,r=0;for(t in e)e.hasOwnProperty(t)&&r++;return r},Object.child=function(e,t){return this.hasOwnProperty(e)?"function"!=typeof t||t(this[e]):void 0},Object.alt=function(e,t){return this.hasOwnProperty(e)?this[e]:t},Object.has=function(e){return this.hasOwnProperty(e)};const storageKey=location.pathname.replace(/\/$/s,"")+"/formField";let formFieldBuild;const formSaved=localStorage.getItem(storageKey.toString());formFieldBuild=formSaved?JSON.parse(formSaved):[];const formField=formFieldBuild,uniqueid=makeid(5),isBrowser=new Function("try {return this===window;}catch(e){ return false;}");let Count=-1;if("undefined"==typeof Storage){}class lStorage extends Storage{constructor(e=""){super(),this.prefix="",this.prefix=e}has(e){return!!localStorage[this.prefix+e]&&!!localStorage[this.prefix+e].length}get(e){if(!this.has(this.prefix+e))return!1;var t=localStorage[this.prefix+e];try{return JSON.parse(t)}catch(e){return t}}set(e,t){try{localStorage.setItem(this.prefix+e,JSON.stringify(t))}catch(r){localStorage.setItem(this.prefix+e,t)}}extend(e,t){if(this.has(this.prefix+e)){var r=this.get(this.prefix+e);"undefined"!=typeof jQuery&&$.extend(r,JSON.parse(JSON.stringify(t))),this.set(this.prefix+e,r)}else this.set(this.prefix+e,t)}remove(e){localStorage.removeItem(this.prefix+e)}}class formSaver2Storage{static set(e,t){("object"==typeof t||Array.isArray(t))&&(t=JSON.stringify(t)),"string"!=typeof t&&(t=new String(t)),localStorage.setItem(e,t)}static get(e,t){let r=localStorage.getItem(e);return this.IsJsonString(r)&&(r=JSON.parse(r)),null!=r?r:t}static IsJsonString(e){if(null==e)return!1;try{JSON.parse(e)}catch(e){return!1}return!0}}class formSaver2{static offset(e){return e.getBoundingClientRect()}static jquery_listener(){$(document).bind("DOMNodeInserted",(function(){switch($(this).prop("tagName")){case"SELECT":case"INPUT":case"TEXTAREA":formSaver2.restore($(this).get(0))}})),$(document).bind("DOMNodeRemoved",(function(){const e=$(this);if(!e.attr("no-save")&&e.attr("formsaver-integrity"))switch(e.prop("tagName")){case"SELECT":case"INPUT":case"TEXTAREA":e.off("change")}})),$(document).on("change","select, input, textarea",(function(e){formSaver2.save(this)})),$(document).on("focus","input,textarea,select",(function(){const e=$(this);e.getIDName();const t=e.attr("formsaver-integrity");t&&t!=uniqueid&&(console.log("aria id invalid"),e.smartForm(),e.attr("formsaver-integrity",uniqueid))}))}static vanilla_listener(e,t){e.addEventListener?e.addEventListener("change",t):e.attachEvent&&e.attachEvent("onchange",t)}static hasAttribute(e,t){return 1===e.nodeType&&e.hasAttribute(t)}static convertElement(e){this.is_jquery()&&e instanceof jQuery&&(e=e.get(0));e.nodeType;return e}static restore(e,t=!1){if(e=this.convertElement(e),Count++,e.hasAttribute("no-save"))return;let r;e.setAttribute("formsaver-integrity",uniqueid);const i=this.get_identifier(e),n=e.getAttribute("type");if(i.length>0){if("checkbox"===n){if(r=JSON.parse(localStorage.getItem(i)),null===r)return;return t&&console.log(`restore value checkbox[${i}] ${r}`),void(e.checked=r)}if("radio"===n){let r=localStorage.getItem(i);formSaver2Storage.IsJsonString(r)&&(r=JSON.parse(r));const n=document.getElementsByName(e.getAttribute("name"));for(let e=0;e<n.length;e++)n[e].checked=!1;return void setTimeout((function(){r&&"object"==typeof r&&r.hasOwnProperty("index")&&(n[r.index].checked=!0,t&&console.log("restoring checkbox",r))}),1e3)}if(r=localStorage.getItem(i),null===r||!r.toString().length)return;e.value=r,this.is_select2(e)&&(console.log(`restoring ${e.getAttribute("id")} which Initialized select2`),$(e).val(r).trigger("change"))}}static save(e,t=!1){e=this.convertElement(e);const r=this.get_identifier(e),i=e.value,n=!e.hasAttribute("no-save")&&e.hasAttribute("formsaver-integrity")&&e.hasAttribute("name");if(t&&console.log(`${e.tagName} ${r} ${n}`),r&&""!==i&&n){if("checkbox"==e.getAttribute("type"))return localStorage.setItem(r,(1==e.checked).toString()),void(t&&console.log("save checkbox button ",formSaver2.offset(e)));if("radio"==e.getAttribute("type")){const i=document.getElementsByName(e.getAttribute("name")),n=getCheckedValue(i),o=this;for(let e=0;e<i.length;e++)if(i.hasOwnProperty(e)){const r=i[e];o.delete(r,t)}return void setTimeout((function(){localStorage.setItem(r,JSON.stringify(n)),t&&console.log("save radio button ",n)}),1e3)}localStorage.setItem(r,i.toString())}}static delete(e,t=!1){e=this.convertElement(e);const r=this.get_identifier(e);t&&console.log(`deleting ${r}`),localStorage.removeItem(r)}static is_select2(e){return this.is_jquery()&&$(e).data("select2")}static is_jquery(){return"undefined"!=typeof jQuery}static get_identifier(e){const t=function(t){let r;return Count in formField?(r=formField[Count],e.setAttribute(t,r)):(r=makeid(5),e.setAttribute(t,r),formField[Count]=r,localStorage.setItem(storageKey.toString(),JSON.stringify(formField))),Count++,r},r=function(t){const r=makeid(5);return e.setAttribute(t,r),formField[Count]=r,localStorage.setItem(storageKey.toString(),JSON.stringify(formField)),r};let i=null,n=null;return(e=this.convertElement(e)).hasAttribute("id")?"null"==e.getAttribute("id")&&(n=r("id")):i=t("id"),e.hasAttribute("name")?"null"==e.getAttribute("name")&&("string"!=typeof n?r("name"):e.setAttribute("name",n)):"string"!=typeof i?t("name"):e.setAttribute("name",i),location.pathname+e.getAttribute("id")}constructor(e,t){"object"!=typeof t&&(t={}),void 0===(t=Object.assign({debug:!1,method:"vanilla"},t)).debug&&(t.debug=!1,console.log("change debug to false")),formSaver2.restore(e,t.debug),e.hasAttribute("formsaver-integrity")||("jquery"==t.method&&formSaver2.is_jquery()?formSaver2.jquery_listener():formSaver2.vanilla_listener(e,(function(){console.log(arguments),formSaver2.save(e,t.debug)})))}}function getCheckedValue(e){let t={};for(let r=0,i=e.length;r<i;r++)e[r].checked&&(t={value:e[r].value,index:r,id:formSaver2.get_identifier(e[r])});return t}function formsaver(e=!1){if("undefined"!=typeof jQuery)e&&console.log(`starting form saver with jQuery debug(${e})`),"undefined"!=typeof jQuery&&jQuery("input,textarea,select").each((function(t,r){new formSaver2(this,{debug:e,method:"jquery"})}));else{e&&console.log(`starting form saver without jQuery debug(${e})`);var t=document.querySelectorAll("input,textarea,select");e&&console.log(t),t.forEach((function(t,r,i){new formSaver2(t,{debug:e,method:"vanilla"})}))}}isBrowser()&&"undefined"!=typeof jQuery&&function(e){e.fn.getIDName=function(){return e(this).attr("aria-autovalue")&&e(this).val(uniqueid).trigger("change"),formSaver2.get_identifier(this)},e.fn.has_attr=function(t){var r=e(this).attr(t);return void 0!==r&&!1!==r},e.fn.smartForm=function(){Count++,new formSaver2(e(this).get(0))},e.arrive=function(t,r){t?e(t).bind("DOMNodeInserted",r):"function"==typeof r?e(document).bind("DOMNodeInserted",r):"function"==typeof t&&e(document).bind("DOMNodeInserted",t)}}(jQuery);