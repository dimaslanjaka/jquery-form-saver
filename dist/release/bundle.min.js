function t(t){let e="";const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=r.length;for(let i=0;i<t;i++)e+=r.charAt(Math.floor(Math.random()*n));return e}Object.size=function(t){var e,r=0;for(e in t)t.hasOwnProperty(e)&&r++;return r},Object.child=function(t,e){return this.hasOwnProperty(t)?"function"!=typeof e||e(this[t]):void 0},Object.alt=function(t,e){return this.hasOwnProperty(t)?this[t]:e},Object.has=function(t){return this.hasOwnProperty(t)};const e=location.pathname.replace(/\/$/s,"")+"/formField";let r;const n=localStorage.getItem(e.toString());r=n?JSON.parse(n):[];const i=r,o=t(5),s=new Function("try {return this===window;}catch(e){ return false;}");let a=-1;if("undefined"==typeof Storage){}class c extends Storage{constructor(t=""){super(),this.prefix="",this.prefix=t}has(t){return!!localStorage[this.prefix+t]&&!!localStorage[this.prefix+t].length}get(t){if(!this.has(this.prefix+t))return!1;var e=localStorage[this.prefix+t];try{return JSON.parse(e)}catch(t){return e}}set(t,e){try{localStorage.setItem(this.prefix+t,JSON.stringify(e))}catch(r){localStorage.setItem(this.prefix+t,e)}}extend(t,e){if(this.has(this.prefix+t)){var r=this.get(this.prefix+t);"undefined"!=typeof jQuery&&$.extend(r,JSON.parse(JSON.stringify(e))),this.set(this.prefix+t,r)}else this.set(this.prefix+t,e)}remove(t){localStorage.removeItem(this.prefix+t)}}class l{static set(t,e){("object"==typeof e||Array.isArray(e))&&(e=JSON.stringify(e)),"string"!=typeof e&&(e=new String(e)),localStorage.setItem(t,e)}static get(t,e){let r=localStorage.getItem(t);return this.IsJsonString(r)&&(r=JSON.parse(r)),null!=r?r:e}static IsJsonString(t){if(null==t)return!1;try{JSON.parse(t)}catch(t){return!1}return!0}}class u{static offset(t){return t.getBoundingClientRect()}static jquery_listener(){$(document).bind("DOMNodeInserted",(function(){switch($(this).prop("tagName")){case"SELECT":case"INPUT":case"TEXTAREA":u.restore($(this).get(0))}})),$(document).bind("DOMNodeRemoved",(function(){const t=$(this);if(!t.attr("no-save")&&t.attr("formsaver-integrity"))switch(t.prop("tagName")){case"SELECT":case"INPUT":case"TEXTAREA":t.off("change")}})),$(document).on("change","select, input, textarea",(function(t){u.save(this)})),$(document).on("focus","input,textarea,select",(function(){const t=$(this);t.getIDName();const e=t.attr("formsaver-integrity");e&&e!=o&&(console.log("aria id invalid"),t.smartForm(),t.attr("formsaver-integrity",o))}))}static vanilla_listener(t,e){t.addEventListener?t.addEventListener("change",e):t.attachEvent&&t.attachEvent("onchange",e)}static hasAttribute(t,e){return 1===t.nodeType&&t.hasAttribute(e)}static convertElement(t){this.is_jquery()&&t instanceof jQuery&&(t=t.get(0));t.nodeType;return t}static restore(t,e=!1){if(t=this.convertElement(t),a++,t.hasAttribute("no-save"))return;let r;t.setAttribute("formsaver-integrity",o);const n=this.get_identifier(t),i=t.getAttribute("type");if(n.length>0){if("checkbox"===i){if(r=JSON.parse(localStorage.getItem(n)),null===r)return;return e&&console.log(`restore value checkbox[${n}] ${r}`),void(t.checked=r)}if("radio"===i){let r=localStorage.getItem(n);l.IsJsonString(r)&&(r=JSON.parse(r));const i=document.getElementsByName(t.getAttribute("name"));for(let t=0;t<i.length;t++)i[t].checked=!1;return void setTimeout((function(){r&&"object"==typeof r&&r.hasOwnProperty("index")&&(i[r.index].checked=!0,e&&console.log("restoring checkbox",r))}),1e3)}if(r=localStorage.getItem(n),null===r||!r.toString().length)return;t.value=r,this.is_select2(t)&&(console.log(`restoring ${t.getAttribute("id")} which Initialized select2`),$(t).val(r).trigger("change"))}}static save(t,e=!1){t=this.convertElement(t);const r=this.get_identifier(t),n=t.value,i=!t.hasAttribute("no-save")&&t.hasAttribute("formsaver-integrity")&&t.hasAttribute("name");if(e&&console.log(`${t.tagName} ${r} ${i}`),r&&""!==n&&i){if("checkbox"==t.getAttribute("type"))return localStorage.setItem(r,(1==t.checked).toString()),void(e&&console.log("save checkbox button ",u.offset(t)));if("radio"==t.getAttribute("type")){const n=document.getElementsByName(t.getAttribute("name")),i=g(n),o=this;for(let t=0;t<n.length;t++)if(n.hasOwnProperty(t)){const r=n[t];o.delete(r,e)}return void setTimeout((function(){localStorage.setItem(r,JSON.stringify(i)),e&&console.log("save radio button ",i)}),1e3)}localStorage.setItem(r,n.toString())}}static delete(t,e=!1){t=this.convertElement(t);const r=this.get_identifier(t);e&&console.log(`deleting ${r}`),localStorage.removeItem(r)}static is_select2(t){return this.is_jquery()&&$(t).data("select2")}static is_jquery(){return"undefined"!=typeof jQuery}static get_identifier(r){const n=function(n){let o;return a in i?(o=i[a],r.setAttribute(n,o)):(o=t(5),r.setAttribute(n,o),i[a]=o,localStorage.setItem(e.toString(),JSON.stringify(i))),a++,o},o=function(n){const o=t(5);return r.setAttribute(n,o),i[a]=o,localStorage.setItem(e.toString(),JSON.stringify(i)),o};let s=null,c=null;return(r=this.convertElement(r)).hasAttribute("id")?"null"==r.getAttribute("id")&&(c=o("id")):s=n("id"),r.hasAttribute("name")?"null"==r.getAttribute("name")&&("string"!=typeof c?o("name"):r.setAttribute("name",c)):"string"!=typeof s?n("name"):r.setAttribute("name",s),location.pathname+r.getAttribute("id")}constructor(t,e){"object"!=typeof e&&(e={}),void 0===(e=Object.assign({debug:!1,method:"vanilla"},e)).debug&&(e.debug=!1,console.log("change debug to false")),u.restore(t,e.debug),"jquery"==e.method&&u.is_jquery()?u.jquery_listener():(console.log("vanilla listener started"),u.vanilla_listener(t,(function(){console.log(arguments),u.save(t,e.debug)})))}}function g(t){let e={};for(let r=0,n=t.length;r<n;r++)t[r].checked&&(e={value:t[r].value,index:r,id:u.get_identifier(t[r])});return e}function f(t=!1){if("undefined"!=typeof jQuery)t&&console.log(`starting form saver with jQuery debug(${t})`),"undefined"!=typeof jQuery&&jQuery("input,textarea,select").each((function(e,r){new u(this,{debug:t,method:"jquery"})}));else{t&&console.log(`starting form saver without jQuery debug(${t})`);var e=document.querySelectorAll("input,textarea,select");t&&console.log(e),e.forEach((function(e,r,n){new u(e,{debug:t,method:"vanilla"})}))}}s()&&"undefined"!=typeof jQuery&&function(t){t.fn.getIDName=function(){return t(this).attr("aria-autovalue")&&t(this).val(o).trigger("change"),u.get_identifier(this)},t.fn.has_attr=function(e){var r=t(this).attr(e);return void 0!==r&&!1!==r},t.fn.smartForm=function(){a++,new u(t(this).get(0))},t.arrive=function(e,r){e?t(e).bind("DOMNodeInserted",r):"function"==typeof r?t(document).bind("DOMNodeInserted",r):"function"==typeof e&&t(document).bind("DOMNodeInserted",e)}}(jQuery);