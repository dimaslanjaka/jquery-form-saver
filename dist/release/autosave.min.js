!function(){"use strict";function t(t){for(var e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<t;r++)e+=n.charAt(Math.floor(62*Math.random()));return e}var e=window.self!==window.top,n=new URL(e?document.referrer:document.location.href).pathname;var r=n.replace(/\/$/,"")+"/formField",o=localStorage.getItem(r.toString()),i=o?JSON.parse(o):[],a=t(5),c=-1;"undefined"!=typeof jQuery&&function(t){t.fn.getIDName=function(){return t(this).attr("aria-autovalue")&&t(this).val(a).trigger("change"),t(this).attr("name")||t(this).attr("id")},t.fn.has_attr=function(e){var n=t(this).attr(e);return void 0!==n&&!1!==n},t.fn.smartForm=function(){c++,new s(t(this).get(0))},t.arrive=function(e,n){e?t(e).bind("DOMNodeInserted",n):"function"==typeof n?t(document).bind("DOMNodeInserted",n):"function"==typeof e&&t(document).bind("DOMNodeInserted",e)}}(jQuery);var u,s=function(){function e(t,e){var n=this;"object"!=typeof e&&(e={}),void 0===(e=Object.assign({debug:!1,method:"vanilla"},e)).debug&&(e.debug=!1,console.log("change debug to false")),this.restore(t,e.debug),"jquery"==e.method&&this.is_jquery()?this.jquery_listener():(console.log("vanilla listener started"),this.vanilla_listener(t,function(){n.save(t,e.debug)}))}return e.prototype.offset=function(t){return t.getBoundingClientRect()},e.prototype.jquery_listener=function(){var t=this;$(document).bind("DOMNodeInserted",function(){switch($(this).prop("tagName")){case"SELECT":case"INPUT":case"TEXTAREA":t.restore($(this).get(0))}}),$(document).bind("DOMNodeRemoved",function(){var t=$(this);if(!t.attr("no-save")&&t.attr("formsaver-integrity"))switch(t.prop("tagName")){case"SELECT":case"INPUT":case"TEXTAREA":t.off("change")}}),$(document).on("change","select, input, textarea",function(e){t.save(this)}),$(document).on("focus","input,textarea,select",function(){var t=$(this);t.getIDName();var e=t.attr("formsaver-integrity");e&&e!=a&&(console.log("aria id invalid"),t.smartForm(),t.attr("formsaver-integrity",a))})},e.prototype.vanilla_listener=function(t,e){t.addEventListener?t.addEventListener("change",e):t.attachEvent&&t.attachEvent("onchange",e)},e.prototype.hasAttribute=function(t,e){return 1===t.nodeType&&t.hasAttribute(e)},e.prototype.convertElement=function(t){return this.is_jquery()&&t instanceof jQuery&&(t=t.get(0)),t.nodeType,t},e.prototype.isIgnored=function(t,e){void 0===e&&(e=!1);var n=t.hasAttribute("no-save");if(e){var r=t.id||t.getAttribute("name")||this.get_identifier(t)||"unidentified element";console.log('id="'.concat(r,'" is ignored (').concat(n,")"))}return n},e.prototype.restore=function(t,e){if(void 0===e&&(e=!1),t=this.convertElement(t),c++,this.isIgnored(t,e))"value"in t&&(t.value="");else{var n;t.setAttribute("formsaver-integrity",a);var r=this.get_identifier(t),o=t.getAttribute("type");if(r.length>0){if("checkbox"===o){if(null===(n=JSON.parse(localStorage.getItem(r))))return;return e&&console.log("restore value checkbox[".concat(r,"] ").concat(n)),void(t.checked=n)}if("radio"===o){var i=localStorage.getItem(r);(function(t){if(null==t)return!1;try{JSON.parse(t)}catch(t){return!1}return!0})(i)&&(i=JSON.parse(i));for(var u=document.getElementsByName(t.getAttribute("name")),s=0;s<u.length;s++)u[s].checked=!1;return void setTimeout(function(){i&&"object"==typeof i&&Object.prototype.hasOwnProperty.call(i,"index")&&(u[i.index].checked=!0,e&&console.log("restoring checkbox",i))},1e3)}if(null===(n=localStorage.getItem(r))||!n.toString().length)return;this.isIgnored(t,e)||(t.value=n,this.is_select2(t)&&(console.log("restoring ".concat(t.getAttribute("id")," which Initialized with select2")),"undefined"!=typeof jQuery&&$(t).val(n).trigger("change"))),e&&console.log("load",o,r,n)}}},e.prototype.save=function(t,e){void 0===e&&(e=!1),t=this.convertElement(t);var n=this.get_identifier(t),r=t.value,o=!t.hasAttribute("no-save")&&t.hasAttribute("formsaver-integrity")&&t.hasAttribute("name"),i=t.getAttribute("type");if(e&&console.log("".concat(t.tagName," ").concat(n," ").concat(o)),n&&o){if("checkbox"==i)return localStorage.setItem(n,(1==t.checked).toString()),void(e&&console.log("save checkbox button ",this.offset(t)));if("radio"!=i){if(function(t){if(null==t)return!0;if("string"==typeof t)return 0===t.length;if(Array.isArray(t))return 0===t.length;if(t instanceof Map||t instanceof Set)return 0===t.size;if("object"==typeof t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}return!1}(r))return localStorage.removeItem(n),void(e&&console.log("removed empty value",n));localStorage.setItem(n,r.toString())}else{for(var a=document.getElementsByName(t.getAttribute("name")),c=function(t){for(var e={},n=0,r=t.length;n<r;n++)t[n].checked&&(e={value:t[n].value,index:n,id:this.get_identifier(t[n])});return e}(a),u=0;u<a.length;u++)if(Object.prototype.hasOwnProperty.call(a,u)){var s=a[u];this.delete(s,e)}setTimeout(function(){localStorage.setItem(n,JSON.stringify(c)),e&&console.log("save radio button ",c)},1e3)}}},e.prototype.delete=function(t,e){void 0===e&&(e=!1),t=this.convertElement(t);var n=this.get_identifier(t);e&&console.log("deleting ".concat(n)),localStorage.removeItem(n)},e.prototype.is_select2=function(t){return this.is_jquery()&&$(t).data("select2")},e.prototype.is_jquery=function(){return"undefined"!=typeof jQuery},e.prototype.get_identifier=function(e){var o=function(n){var o;return c in i?(o=i[c],e.setAttribute(n,o)):(o=t(5),e.setAttribute(n,o),i[c]=o,localStorage.setItem(r.toString(),JSON.stringify(i))),c++,o},a=function(n){var o=t(5);return e.setAttribute(n,o),i[c]=o,localStorage.setItem(r.toString(),JSON.stringify(i)),o},u=null,s=null;return(e=this.convertElement(e)).hasAttribute("id")?"null"==e.getAttribute("id")&&(s=a("id")):u=o("id"),e.hasAttribute("name")?"null"==e.getAttribute("name")&&("string"!=typeof s?a("name"):e.setAttribute("name",s)):"string"!=typeof u?o("name"):e.setAttribute("name",u),n+e.getAttribute("id")},e}();u=!1,"undefined"!=typeof jQuery?"undefined"!=typeof jQuery&&jQuery("input,textarea,select").each(function(t,e){new s(this,{debug:u,method:"jquery"})}):document.querySelectorAll("input,textarea,select").forEach(function(t,e,n){new s(t,{debug:u,method:"vanilla"})})}();
//# sourceMappingURL=autosave.min.js.map
