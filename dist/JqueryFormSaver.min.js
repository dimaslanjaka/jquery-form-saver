!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).JqueryFormSaver=e()}(this,(function(){"use strict";function t(t){for(var e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=0;o<t;o++)e+=n.charAt(Math.floor(62*Math.random()));return e}var e=location.pathname.replace(/\/$/s,"")+"/formField",n=localStorage.getItem(e.toString()),o=n?JSON.parse(n):[],r=t(5),i=-1;return function(){function n(t,e){var n=this;"object"!=typeof e&&(e={}),void 0===(e=Object.assign({debug:!1,method:"vanilla"},e)).debug&&(e.debug=!1,console.log("change debug to false")),this.restore(t,e.debug),"jquery"==e.method&&this.is_jquery()?this.jquery_listener():(console.log("vanilla listener started"),this.vanilla_listener(t,(function(){n.save(t,e.debug)})))}return n.prototype.offset=function(t){return t.getBoundingClientRect()},n.prototype.jquery_listener=function(){var t=this;$(document).bind("DOMNodeInserted",(function(){switch($(this).prop("tagName")){case"SELECT":case"INPUT":case"TEXTAREA":t.restore($(this).get(0))}})),$(document).bind("DOMNodeRemoved",(function(){var t=$(this);if(!t.attr("no-save")&&t.attr("formsaver-integrity"))switch(t.prop("tagName")){case"SELECT":case"INPUT":case"TEXTAREA":t.off("change")}})),$(document).on("change","select, input, textarea",(function(e){t.save(this)})),$(document).on("focus","input,textarea,select",(function(){var t=$(this);t.getIDName();var e=t.attr("formsaver-integrity");e&&e!=r&&(console.log("aria id invalid"),t.smartForm(),t.attr("formsaver-integrity",r))}))},n.prototype.vanilla_listener=function(t,e){t.addEventListener?t.addEventListener("change",e):t.attachEvent&&t.attachEvent("onchange",e)},n.prototype.hasAttribute=function(t,e){return 1===t.nodeType&&t.hasAttribute(e)},n.prototype.convertElement=function(t){return this.is_jquery()&&t instanceof jQuery&&(t=t.get(0)),t.nodeType,t},n.prototype.isIgnored=function(t,e){void 0===e&&(e=!1);var n=t.hasAttribute("no-save");if(e){var o=t.id||t.getAttribute("name")||this.get_identifier(t)||"unidentified element";console.log('id="'.concat(o,'" is ignored (').concat(n,")"))}return n},n.prototype.restore=function(t,e){if(void 0===e&&(e=!1),t=this.convertElement(t),i++,this.isIgnored(t,e))"value"in t&&(t.value="");else{var n;t.setAttribute("formsaver-integrity",r);var o=this.get_identifier(t),a=t.getAttribute("type");if(o.length>0){if("checkbox"===a){if(null===(n=JSON.parse(localStorage.getItem(o))))return;return e&&console.log("restore value checkbox[".concat(o,"] ").concat(n)),void(t.checked=n)}if("radio"===a){var s=localStorage.getItem(o);(function(t){if(null==t)return!1;try{JSON.parse(t)}catch(t){return!1}return!0})(s)&&(s=JSON.parse(s));for(var c=document.getElementsByName(t.getAttribute("name")),u=0;u<c.length;u++)c[u].checked=!1;return void setTimeout((function(){s&&"object"==typeof s&&Object.prototype.hasOwnProperty.call(s,"index")&&(c[s.index].checked=!0,e&&console.log("restoring checkbox",s))}),1e3)}if(null===(n=localStorage.getItem(o))||!n.toString().length)return;this.isIgnored(t,e)||(t.value=n,this.is_select2(t)&&(console.log("restoring ".concat(t.getAttribute("id")," which Initialized with select2")),"undefined"!=typeof jQuery&&$(t).val(n).trigger("change"))),e&&console.log("load",a,o,n)}}},n.prototype.save=function(t,e){void 0===e&&(e=!1),t=this.convertElement(t);var n=this.get_identifier(t),o=t.value,r=!t.hasAttribute("no-save")&&t.hasAttribute("formsaver-integrity")&&t.hasAttribute("name");if(e&&console.log("".concat(t.tagName," ").concat(n," ").concat(r)),n&&""!==o&&r){if("checkbox"==t.getAttribute("type"))return localStorage.setItem(n,(1==t.checked).toString()),void(e&&console.log("save checkbox button ",this.offset(t)));if("radio"==t.getAttribute("type")){for(var i=document.getElementsByName(t.getAttribute("name")),a=function(t){for(var e={},n=0,o=t.length;n<o;n++)t[n].checked&&(e={value:t[n].value,index:n,id:this.get_identifier(t[n])});return e}(i),s=0;s<i.length;s++)if(Object.prototype.hasOwnProperty.call(i,s)){var c=i[s];this.delete(c,e)}return void setTimeout((function(){localStorage.setItem(n,JSON.stringify(a)),e&&console.log("save radio button ",a)}),1e3)}localStorage.setItem(n,o.toString())}},n.prototype.delete=function(t,e){void 0===e&&(e=!1),t=this.convertElement(t);var n=this.get_identifier(t);e&&console.log("deleting ".concat(n)),localStorage.removeItem(n)},n.prototype.is_select2=function(t){return this.is_jquery()&&$(t).data("select2")},n.prototype.is_jquery=function(){return"undefined"!=typeof jQuery},n.prototype.get_identifier=function(n){var r=function(r){var a;return i in o?(a=o[i],n.setAttribute(r,a)):(a=t(5),n.setAttribute(r,a),o[i]=a,localStorage.setItem(e.toString(),JSON.stringify(o))),i++,a},a=function(r){var a=t(5);return n.setAttribute(r,a),o[i]=a,localStorage.setItem(e.toString(),JSON.stringify(o)),a},s=null,c=null;return(n=this.convertElement(n)).hasAttribute("id")?"null"==n.getAttribute("id")&&(c=a("id")):s=r("id"),n.hasAttribute("name")?"null"==n.getAttribute("name")&&("string"!=typeof c?a("name"):n.setAttribute("name",c)):"string"!=typeof s?r("name"):n.setAttribute("name",s),location.pathname+n.getAttribute("id")},n}()}));
//# sourceMappingURL=JqueryFormSaver.min.js.map
